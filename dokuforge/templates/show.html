{# Copyright (c) 2012, Klaus Aehlig, Helmut Grohne, Markus Oehme
 #
 # This program is free software: you can redistribute it and/or modify
 # it under the terms of the three-clause BSD license.
 #
 # This program is distributed in the hope that it will be useful,
 # but WITHOUT ANY WARRANTY; without even the implied warranty of
 # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 #
 # You should have received a copy of the Three-Clause BSD License
 # along with this program in the file COPYING.
 # If not, see <http://opensource.org/licenses/bsd-3-clause>
 #}
{% extends "base.html" %}
{% block subheading %}
{{ academy.title|e }}
{% endblock %}
{% block location %}
{{ navbar([("academy", {}, academy.title),
           ("course", {}, course.title),
	   ("page", {}, "Teil #" ~ page)]) }}
{% endblock %}
{% block content %}
Teil #{{ page|string }}
[Version {{commit['revision'] | e }}, 
 zulezt ge&auml;ndert von {{ commit['author'] | e }}
 am {{ commit['date'] | e }}]
<hr>
<div class="dokucontent">
{# content does not need to be escaped, since this is done by the parser #}
{{ content }}
</div>
<hr>


{%- if user.allowedWrite(academy, course) %}
<a href="{{ buildurl("edit")|e }}">Editieren</a>
{{ button(buildurl("delete"), "Löschen", dict()) }}
{%- endif -%}
<a href="{{ buildurl("rcs")|e }}">rcs</a>

<hr>
{%- if blobs %}
Zugeordnete Bilder:
<ul>
{%- for blob in blobs %}
<li>
  <a href="{{ buildurl("showblob", {'blob': blob.number})|e }}">#[{{ blob.number|string }}] ({{ blob.filename|e }})</a>
{%- if user.allowedWrite(academy, course) %}
{{ button(buildurl("blobdelete", {'blob': blob.number}), "Löschen", dict()) }}
{%- endif -%}
</li>
{%- endfor %}
</ul>
{%- else -%}
<em>Keine Bilder zu diesem Teil gefunden.</em>
{%- endif -%}

{%- if user.allowedWrite(academy, course) %}
<a href="{{ buildurl("addblob")|e }}">neues Bild hinzuf&uuml;gen</a>
<a href="{{ buildurl("showdeadblobs")|e }}">gel&ouml;schte Bilder hier wieder einf&uuml;gen</a>
{%- endif -%}

{% endblock %}
