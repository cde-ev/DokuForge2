{% extends "base.html" %}
{% block subheading %}
{{ academy.title|e }}
{% endblock %}
{% block location %}
{{ navbar([("academy", {}, academy.title),
           ("course", {}, course.title),
	   ("page", {}, "Teil #" ~ page)]) }}
{% endblock %}
{% block content %}
Teil #{{ page|string }}
[Version {{commit['revision'] | e }}, 
 zulezt ge&auml;ndert von {{ commit['author'] | e }}
 am {{ commit['date'] | e }}]
<hr>
<div class="dokucontent">
{# content does not need to be escaped, since this is done by the parser #}
{{ content }}
</div>
<hr>

{%- if user.allowedWrite(academy, course) %}
{{ fakebutton(buildurl("edit"), "Editieren") }}
{{ button(buildurl("delete"), "Löschen", dict()) }}
{%- endif -%}
{{ fakebutton(buildurl("rcs"), "rcs") }}

<hr>
{%- if blobs %}
Zugeordnete Bilder:
<ul>
{%- for blob in blobs %}
<li>
  <a href="{{ buildurl("showblob", {'blob': blob.number})|e }}">#[{{ blob.number|string }}] ({{ blob.filename|e }})</a>
{%- if user.allowedWrite(academy, course) %}
{{ button(buildurl("blobdelete", {'blob': blob.number}), "Löschen", dict()) }}
{%- endif -%}
</li>
{%- endfor %}
</ul>
{%- else -%}
<em>Keine Bilder zu diesem Teil gefunden.</em>
{%- endif -%}

{%- if user.allowedWrite(academy, course) %}
{{ fakebutton(buildurl("addblob"), "neues Bild hinzufügen") }}
{{ fakebutton(buildurl("showdeadblobs"), "gelöschte Bilder hier wieder einfügen") }}
{%- endif -%}

{% endblock %}
