{% extends "base.html" %}
{% block subheading %}
{{ academy.title|e }}
{% endblock %}
{% block location %}
{{ navbar([("academy", {}, academy.title),
           ("course", {}, course.title),
	   ("page", {}, "Teil #" ~ page)]) }}
{% endblock %}
{% block content %}
Teil #{{ page|string }}
[Version {{commit['revision'] | e }}, 
 zuletzt ge&auml;ndert von {{ commit['author'] | e }}
 am {{ commit['date'] | e }}]
<hr>
<div class="dokucontent">
{# content does not need to be escaped, since this is done by the parser #}
{{ content }}
</div>
<hr>


{%- if user.allowedWrite(academy, course) %}
<a href="{{ buildurl("edit")|e }}" class="yui3-button darkshade">Editieren</a>
{{ button(buildurl("delete"), "Löschen", dict()) }}
{%- endif -%}
<a href="{{ buildurl("rcs")|e }}" class="yui3-button darkshade">rcs</a>

<hr>
{%- if blobs %}
Zugeordnete Bilder:
<ul>
{%- for blob in blobs %}
<li>
  <a href="{{ buildurl("showblob", {'blob': blob.number})|e }}">#[{{ blob.number|string }}] ({{ blob.filename|e }})</a>
{%- if user.allowedWrite(academy, course) %}
{{ button(buildurl("blobdelete", {'blob': blob.number}), "Löschen", dict()) }}
{%- endif -%}
</li>
{%- endfor %}
</ul>
{%- else -%}
<em>Keine Bilder zu diesem Teil gefunden.</em>
{%- endif -%}

{%- if user.allowedWrite(academy, course) %}
<a href="{{ buildurl("addblob")|e }}" class="yui3-button darkshade">neues Bild hinzuf&uuml;gen</a>
<a href="{{ buildurl("showdeadblobs")|e }}" class="yui3-button darkshade">gel&ouml;schte Bilder hier wieder einf&uuml;gen</a>
{%- endif -%}

{% endblock %}
